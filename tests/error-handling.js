/**
 * Updated test file for MCP compatibility
 * Generated by update-test-expectations.js
 */

export default [
  {
    "name": "Custom error with stack trace",
    "code": "const err = new Error(\"Custom error with stack\"); throw err;",
    "expectedError": "Custom error with stack",
    "expected": ({ outputs, returnValue, fullOutput }) => {
      // The error might be in outputs or in returnValue, or in fullOutput depending on how the REPL reports it
      const allText = [fullOutput, returnValue, ...(outputs || [])].join(' ');
      return allText.includes('Custom error with stack') && 
             (allText.includes('Error:') || allText.includes('ERROR:')) &&
             (allText.includes('at eval') || allText.includes('at evalmachine'));
    }
  },
  {
    "name": "Error with custom properties",
    "code": "const err = new Error(\"With props\"); err.code = \"ERR_CUSTOM\"; throw err;",
    "expectedError": "ERR_CUSTOM",
    "expected": ({ outputs, returnValue, fullOutput }) => {
      // The error might be in outputs or in returnValue, or in fullOutput depending on how the REPL reports it
      const allText = [fullOutput, returnValue, ...(outputs || [])].join(' ');
      return allText.includes('With props') && 
             (allText.includes('Error:') || allText.includes('ERROR:')) &&
             (allText.includes('at eval') || allText.includes('at evalmachine'));
    }
  },
  {
    "name": "TypeError with message",
    "code": "throw new TypeError(\"Invalid type provided\");",
    "expectedError": "TypeError: Invalid type provided",
    "expected": ({ outputs, returnValue, fullOutput }) => {
      // The error might be in outputs or in returnValue, or in fullOutput depending on how the REPL reports it
      const allText = [fullOutput, returnValue, ...(outputs || [])].join(' ');
      return allText.includes('Invalid type provided') && 
             allText.includes('TypeError') &&
             (allText.includes('at eval') || allText.includes('at evalmachine'));
    }
  },
  {
    "name": "SyntaxError direct throw",
    "code": "throw new SyntaxError(\"Invalid syntax\");",
    "expectedError": "SyntaxError: Invalid syntax",
    "expected": ({ outputs, returnValue, fullOutput }) => {
      // The error might be in outputs or in returnValue, or in fullOutput depending on how the REPL reports it
      const allText = [fullOutput, returnValue, ...(outputs || [])].join(' ');
      return allText.includes('Invalid syntax') && 
             allText.includes('SyntaxError') &&
             (allText.includes('at eval') || allText.includes('at evalmachine'));
    }
  },
  {
    "name": "RangeError direct throw",
    "code": "throw new RangeError(\"Value out of range\");",
    "expectedError": "RangeError: Value out of range",
    "expected": ({ outputs, returnValue, fullOutput }) => {
      // The error might be in outputs or in returnValue, or in fullOutput depending on how the REPL reports it
      const allText = [fullOutput, returnValue, ...(outputs || [])].join(' ');
      return allText.includes('Value out of range') && 
             allText.includes('RangeError') &&
             (allText.includes('at eval') || allText.includes('at evalmachine'));
    }
  },
  {
    "name": "URIError direct throw",
    "code": "throw new URIError(\"Invalid URI\");",
    "expectedError": "URIError: Invalid URI",
    "expected": ({ outputs, returnValue, fullOutput }) => {
      // The error might be in outputs or in returnValue, or in fullOutput depending on how the REPL reports it
      const allText = [fullOutput, returnValue, ...(outputs || [])].join(' ');
      return allText.includes('Invalid URI') && 
             allText.includes('URIError') &&
             (allText.includes('at eval') || allText.includes('at evalmachine'));
    }
  },
  {
    "name": "EvalError direct throw",
    "code": "throw new EvalError(\"Eval error\");",
    "expectedError": "EvalError: Eval error",
    "expected": ({ outputs, returnValue, fullOutput }) => {
      // The error might be in outputs or in returnValue, or in fullOutput depending on how the REPL reports it
      const allText = [fullOutput, returnValue, ...(outputs || [])].join(' ');
      return allText.includes('Eval error') && 
             allText.includes('EvalError') &&
             (allText.includes('at eval') || allText.includes('at evalmachine'));
    }
  },
  {
    "name": "Nested try-catch blocks",
    "code": "\n      try {\n        try {\n          throw new Error(\"Inner error\");\n        } catch (innerErr) {\n          throw new Error(\"Outer error: \" + innerErr.message);\n        }\n      } catch (err) {\n        return \"Caught: \" + err.message;\n      }\n    ",
    "expectedResult": "Caught: Outer error: Inner error",
    "expected": "Caught: Outer error: Inner error"
  },
  {
    "name": "Custom error class",
    "code": "\n      class CustomError extends Error {\n        constructor(message) {\n          super(message);\n          this.name = \"CustomError\";\n        }\n      }\n      try {\n        throw new CustomError(\"Custom error message\");\n      } catch (err) {\n        return `${err.name}: ${err.message}`;\n      }\n    ",
    "expectedResult": "CustomError: Custom error message",
    "expected": "CustomError: Custom error message"
  },
  {
    "name": "Error in callback",
    "code": "\n      function executeCallback(cb) {\n        try {\n          return cb();\n        } catch (err) {\n          return \"Error in callback: \" + err.message;\n        }\n      }\n      return executeCallback(() => { throw new Error(\"Callback failed\"); });\n    ",
    "expectedResult": "Error in callback: Callback failed",
    "expected": "Error in callback: Callback failed"
  },
  {
    "name": "Deep stack trace",
    "code": "\n      function level3() { throw new Error(\"Deep error\"); }\n      function level2() { level3(); }\n      function level1() { level2(); }\n      try {\n        level1();\n      } catch (err) {\n        return err.stack.includes(\"level3\") && err.stack.includes(\"level2\") && err.stack.includes(\"level1\");\n      }\n    ",
    "expectedResult": "true",
    "expected": "true"
  }
];